<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">

<!-- VIEWPORT ESSENCIAL PARA IPHONE -->
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

<title>Automatizador de Receita</title>

<script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>

<style>
:root{
  --safe-top: env(safe-area-inset-top);
  --safe-bottom: env(safe-area-inset-bottom);
  --safe-left: env(safe-area-inset-left);
  --safe-right: env(safe-area-inset-right);
}

*{ -webkit-tap-highlight-color: transparent; }

body{
  margin:0;
  font-family:-apple-system, BlinkMacSystemFont, Arial, sans-serif;
  background:#f4f4f4;
  padding-top:var(--safe-top);
  padding-bottom:var(--safe-bottom);
}

/* ===== CONTAINER ===== */
.container{
  padding:16px;
  max-width:700px;
  margin:auto;
}

/* ===== TOPO ===== */
.topo{
  display:flex;
  flex-direction:column;
  gap:12px;
  margin-bottom:20px;
}
.titulo{
  font-size:22px;
  font-weight:bold;
  text-align:center;
}

.area-pdf{
  text-align:center;
}
.btn-pdf{
  background:#e74c3c;
  color:#fff;
  padding:12px 18px;
  border-radius:8px;
  display:inline-block;
  cursor:pointer;
  font-size:16px;
}
.pdf-status{
  margin-top:6px;
  font-size:13px;
  color:green;
  display:none;
}

/* ===== CAMPOS ===== */
.campo{ margin-bottom:18px; }
label{
  font-weight:bold;
  margin-bottom:6px;
  display:block;
}

input, select, textarea{
  width:100%;
  padding:12px;
  font-size:16px; /* evita zoom no Safari */
  border-radius:8px;
  border:1px solid #ccc;
  box-sizing:border-box;
}

/* ===== DATA ===== */
.data-box{
  display:flex;
  gap:10px;
}
.data-box input{
  text-align:center;
}

/* ===== MEDICAÇÕES ===== */
.medicacao-box{
  background:#fff;
  padding:12px;
  border-radius:10px;
  margin-bottom:12px;
  border:1px solid #ccc;
}

.medicacao-linha{
  display:flex;
  gap:6px;
  align-items:center;
}

.num{
  min-width:34px;
  padding:6px;
  border:1px solid #4a67ff;
  color:#4a67ff;
  border-radius:6px;
  text-align:center;
  font-weight:bold;
}

.btn-lupa, .btn-apagar{
  border:none;
  border-radius:6px;
  padding:10px;
  font-size:16px;
  cursor:pointer;
}
.btn-lupa{ background:#000; color:#fff; }
.btn-apagar{ background:#ff3b3b; color:#fff; }

.btn-add{
  width:100%;
  margin-top:10px;
  background:#2e86de;
  color:#fff;
  border:none;
  border-radius:10px;
  padding:14px;
  font-size:16px;
}

/* ===== BOTÃO GERAR ===== */
button[onclick="gerarPDF()"]{
  width:100%;
  margin-top:20px;
  background:#27ae60;
  color:#fff;
  border:none;
  border-radius:12px;
  padding:16px;
  font-size:18px;
}

/* ===== SIDEBAR (IPHONE FULLSCREEN) ===== */
.sidebar{
  position:fixed;
  inset:0;
  background:#fff;
  transform:translateX(100%);
  transition:.3s;
  z-index:9999;
  padding:16px;
  overflow-y:auto;
}
.sidebar.open{ transform:translateX(0); }

.sidebar .close{
  background:#ff3b3b;
  color:#fff;
  border:none;
  padding:12px;
  border-radius:8px;
  font-size:16px;
  margin-bottom:10px;
  width:100%;
}

.categoria{
  margin-top:16px;
  font-weight:bold;
}

.medicacao-item{
  padding:10px;
  border-bottom:1px dashed #ccc;
  font-size:15px;
}

.medicacao-item:active{
  background:#eee;
}

.add-manual{
  margin-top:20px;
  border-top:2px solid #ccc;
  padding-top:12px;
}
</style>
</head>

<body>

<div class="container">

  <div class="topo">
    <div class="titulo">Preenchimento de Receita</div>
    <div class="area-pdf">
      <label class="btn-pdf">
        Selecionar PDF
        <input type="file" id="pdfBase" accept="application/pdf" hidden>
      </label>
      <div id="pdfStatus" class="pdf-status">(PDF selecionado)</div>
    </div>
  </div>

  <div class="campo">
    <label>NOME DO PACIENTE</label>
    <input id="nomePaciente">
  </div>

  <div class="campo">
    <label>USO</label>
    <select id="uso">
      <option value="">Selecione</option>
      <option>USO ORAL</option>
      <option>USO TÓPICO</option>
    </select>
  </div>

  <div class="campo">
    <label>MEDICAÇÕES</label>
    <div id="listaMedicacoes"></div>
    <button class="btn-add" onclick="adicionarMedicacao()">➕ Adicionar Medicação</button>
  </div>

  <div class="campo">
    <label>DATA</label>
    <div class="data-box">
      <input id="dataDia" placeholder="DD" maxlength="2">
      <input id="dataMes" placeholder="MM" maxlength="2">
      <input id="dataAno" placeholder="AAAA" maxlength="4">
    </div>
  </div>

  <button onclick="gerarPDF()">Gerar Receita</button>
</div>

<!-- SIDEBAR -->
<div id="sidebar" class="sidebar">
  <button class="close" onclick="fecharSidebar()">Fechar</button>
  <h3>Buscar medicação</h3>
  <input placeholder="Buscar..." oninput="renderizarLista(this.value)">
  <div id="listaSidebar"></div>

  <div class="add-manual">
    <strong>➕ Adicionar medicação</strong>
    <input id="manualNome" placeholder="Nome da medicação">
    <textarea id="manualUso" placeholder="Como tomar"></textarea>
    <button class="btn-add" onclick="salvarManual()">Salvar</button>
  </div>
</div>

<!-- ===== SCRIPT ORIGINAL (INALTERADO) ===== -->
<script>
/* TODO O SEU JS ORIGINAL PERMANECE IGUAL */
</script>

</body>
</html>
